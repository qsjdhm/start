<!DOCTYPE html><html lang="en" class="no-js"> <head>	<meta charset="utf-8" />	<title>起步 | 后台管理系统</title> 	<meta content="width=device-width, initial-scale=1.0" name="viewport" />	<meta content="" name="description" />	<meta content="" name="author" />	<!-- BEGIN GLOBAL MANDATORY STYLES -->	<link href="../media/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/style-metro.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/style.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/style-responsive.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>	<link href="../media/css/uniform.default.css" rel="stylesheet" type="text/css"/>	<!-- END GLOBAL MANDATORY STYLES -->	<!-- BEGIN PAGE LEVEL STYLES --> 	<link href="../media/css/jquery.gritter.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/daterangepicker.css" rel="stylesheet" type="text/css" />	<link href="../media/css/fullcalendar.css" rel="stylesheet" type="text/css"/>	<link href="../media/css/jqvmap.css" rel="stylesheet" type="text/css" media="screen"/>	<link href="../media/css/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css" media="screen"/>	<link href="../upload/css/uploadify.css" type="text/css" rel="stylesheet"/>	<style type="text/css" media="print, screen">  		.pagination{			float: right;			margin: 0px;		}    	#myModal{    		margin-left:-146px!important;			width:740px!important;    	}    	</style>   		<!-- END PAGE LEVEL STYLES -->	<link rel="shortcut icon" href="../../image/foot.png" /></head><!-- END HEAD --><!-- BEGIN BODY --><body class="page-header-fixed">	<div class="header navbar navbar-inverse">		<div class="navbar-inner">			<div class="container-fluid">				<a class="brand" href="index.html">					<img src="../media/image/logo.png" alt="logo"/>				</a>				<a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">					<img src="../media/image/menu-toggler.png" alt="" />				</a>          				<ul class="nav pull-right">					<li class="dropdown user">						<a href="#" class="dropdown-toggle" data-toggle="dropdown">						<img alt="" src="../media/image/avatar1_small.jpg" />						<span class="username">文艺青年流川枫</span>						<i class="icon-angle-down"></i>						</a>						<ul class="dropdown-menu">							<li><a href="extra_lock.html"><i class="icon-lock"></i> 修改密码 </a></li>							<li><a href="login.html"><i class="icon-key"></i> 退出 </a></li>						</ul>					</li>				</ul>			</div>		</div>	</div>	<div class="page-container">		<div class="page-sidebar nav-collapse collapse">			<ul class="page-sidebar-menu">				<li>					<div class="sidebar-toggler hidden-phone"></div>				</li>				<li class="start">					<a href="../index.html">						<i class="icon-home"></i> 						<span class="title">欢迎回来</span>						<span class="selected"></span>					</a>				</li>				<li class="">					<a href="javascript:;">						<i class="icon-file-text"></i> 						<span class="title">文章管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="../article/add_article.html">							添加文章</a>						</li>						<li>							<a href="../article/del_article.html">							删除文章</a>						</li>						<li>							<a href="../article/update_article.html">							修改文章</a>						</li>					</ul>				</li>				<li>					<a href="javascript:;">						<i class="icon-bookmark-empty"></i> 						<span class="title">笔记管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="../note/add_note.html">							添加笔记</a>						</li>						<li>							<a href="../note/del_note.html">							删除笔记</a>						</li>						<li>							<a href="../note/update_note.html">							修改笔记</a>						</li>					</ul>				</li>				<li class="">					<a href="javascript:;">						<i class="icon-sitemap"></i> 						<span class="title">笔记分类管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="../note_classify/add_note_classify.html">							添加笔记分类</a>						</li>						<li>							<a href="../note_classify/del_note_classify.html">							删除笔记分类</a>						</li>						<li>							<a href="../note_classify/update_note_classify.html">							修改笔记分类</a>						</li>					</ul>				</li>				<li class="active">					<a href="javascript:;">						<i class="icon-folder-open"></i> 						<span class="title">图书管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="add_book.html">							添加图书</a>						</li>						<li>							<a href="del_book.html">							删除图书</a>						</li>						<li class="active">							<a href="update_book.html">							修改图书</a>						</li>					</ul>				</li>				<li class="">					<a href="javascript:;">						<i class="icon-th"></i> 						<span class="title">图书分类管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="../book_classify/add_book_classify.html">							添加图书分类</a>						</li>						<li>							<a href="../book_classify/del_book_classify.html">							删除图书分类</a>						</li>						<li>							<a href="../book_classify/update_book_classify.html">							修改图书分类</a>						</li>					</ul>				</li>				<li class="last">					<a href="javascript:;">						<i class="icon-gift"></i> 						<span class="title">推荐管理</span>						<span class="arrow "></span>					</a>					<ul class="sub-menu">						<li>							<a href="../recommend/recom_article.html">							推荐文章</a>						</li>						<li>							<a href="../recommend/recom_note.html">							推荐笔记</a>						</li>					</ul>				</li>			</ul>			<!-- END SIDEBAR MENU -->		</div>		<div class="page-content">			<div class="container-fluid">				<!-- BEGIN PAGE HEADER-->				<div class="row-fluid">					<div class="span12">						<!-- BEGIN PAGE TITLE & BREADCRUMB-->						<h3 class="page-title">							修改您不满意的图书 <small></small>						</h3>						<ul class="breadcrumb">							<li>								<i class="icon-home"></i>								<a href="index.html">起步</a> 								<i class="icon-angle-right"></i>							</li>							<li><a href="update_book.html">修改图书 </a></li>							<li class="pull-right no-text-shadow">								<div id="dashboard-report-range" class="dashboard-date-range tooltips no-tooltip-on-touch-device responsive" data-tablet="" data-desktop="tooltips" data-placement="top" data-original-title="Change dashboard date range">									<i class="icon-calendar"></i>									<span></span>									<i class="icon-angle-down"></i>								</div>							</li>						</ul>						<!-- END PAGE TITLE & BREADCRUMB-->					</div>				</div>				<!-- END PAGE HEADER-->				<div id="dashboard">					<div class="row-fluid">					<div class="span12">						<!-- BEGIN EXAMPLE TABLE PORTLET-->						<div class="portlet box blue">							<div class="portlet-title">								<div class="caption"><i class="icon-edit"></i>分类列表</div>								<div class="tools">									<a href="javascript:;" class="collapse"></a>									<a href="#portlet-config" data-toggle="modal" class="config"></a>									<a href="javascript:;" class="reload"></a>									<a href="javascript:;" class="remove"></a>								</div>							</div>							<div class="portlet-body">																<div class="clearfix">									<div style="margin-bottom:0px!important;" class="btn-group">										<select id="typeSelect" style="height:39px!important;line-height:39px!important; " class="small m-wrap" tabindex="0">											<option style="height:30px!important;line-height:30px!important; "  value="0"> 全部 </option>										</select>									</div>								</div>																<table class="table table-striped table-hover table-bordered" id="book_list">									<thead>										<tr>																					<th>ID</th>																						<th>名称</th>																						<th>简介</th>																						<th style="display: none;">下载路径</th>																						<th style="display: none;">分类名</th>																						<th>分类</th>																						<th>高度</th>																						<th>推荐数</th>											<th>修改</th>										</tr>									</thead>									<tbody>																			</tbody>								</table>																<div class="row-fluid">									<div class="span6"></div>									<div class="span6">										<div class="pagination" id="pagination"></div>									</div>								</div>							</div>						</div>						<!-- END EXAMPLE TABLE PORTLET-->					</div>				</div>				<!-- END PAGE CONTENT -->					<!-- END DASHBOARD STATS -->					<div class="clearfix"></div>				</div>			</div>			<!-- END PAGE CONTAINER-->    		</div>		<!-- END PAGE -->	</div>	<!-- END CONTAINER -->			<!-- Modal -->			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">			  <div class="modal-dialog">			    <div class="modal-content">			      <div class="modal-header">			        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>			        <h4 class="modal-title" id="myModalLabel">修改图书内容</h4>			      </div>			      <div class="modal-body">			        <!-- BEGIN DASHBOARD STATS -->					<div class="row-fluid">						<!-- 富文本编辑区域开始 -->												<form action="#" class="form-horizontal">							<div class="control-group">								<label class="control-label">图书名称</label>								<div class="controls">									<input type="hidden" id="bookId" value="" />									<input type="text" id="bookName" placeholder="" class="m-wrap medium" />								</div>							</div>							<div class="control-group">								<label class="control-label">图书类型</label>								<div class="controls">									<select  id="bookType" class="medium m-wrap" tabindex="1">										<option style="height:30px!important;line-height:30px!important; "  value="0"> 全部 </option>									</select>								</div>							</div>							<div class="control-group">								<label class="control-label">图书高度</label>								<div class="controls">									<input  id="bookHeight" type="text" placeholder="" class="m-wrap medium" />								</div>							</div>							<div class="control-group">								<label class="control-label">图书封面</label>								<div class="controls">									<div id="uploader">										<p><input type="file" name="file_upload" id="file_upload" /></p>										<a href="javascript:up()">上传</a>&nbsp;								        <a href="javascript:stop()">取消上传</a>								        <div id="uploader_queue"></div>								        <div id="uploader_msg"></div>										<div id="uploader_view"></div>									 </div>								</div>							</div>							<div class="control-group">								<label class="control-label">下载路径</label>								<div class="controls">									<textarea id="bookDown" class="large m-wrap" rows="1"></textarea>								</div>							</div>							<div class="control-group">								<label class="control-label">图书简介</label>								<div class="controls">									<textarea id="bookBrief" class="large m-wrap" rows="2"></textarea>								</div>							</div>						</form>												<!-- 富文本编辑区域结束 -->											</div>			      </div>			      <div class="modal-footer">			        <button id="saveBook" type="button" data-dismiss="modal" class="blue btn btn-primary">提交更改</button>			        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>			      </div>			    </div><!-- /.modal-content -->			  </div><!-- /.modal-dialog -->			</div><!-- /.modal -->	<!-- BEGIN FOOTER -->	<div class="footer">		<div class="footer-inner">			2013 &copy; Metronic by keenthemes.		</div>		<div class="footer-tools">			<span class="go-top">			<i class="icon-angle-up"></i>			</span>		</div>	</div>	<!-- END FOOTER -->	<script src="../media/js/jquery-1.10.1.min.js" type="text/javascript"></script>	<script src="../media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>	<script src="../media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      	<script src="../media/js/bootstrap.min.js" type="text/javascript"></script>	<script src="../media/js/jquery.slimscroll.min.js" type="text/javascript"></script>	<script src="../media/js/jquery.blockui.min.js" type="text/javascript"></script>  	<script src="../media/js/jquery.cookie.min.js" type="text/javascript"></script>	<script src="../media/js/jquery.uniform.min.js" type="text/javascript" ></script>	<script src="../media/js/jquery.flot.js" type="text/javascript"></script>	<script src="../media/js/jquery.flot.resize.js" type="text/javascript"></script>	<script src="../media/js/app.js" type="text/javascript"></script>	<script src="../media/js/index.js" type="text/javascript"></script>   	<script type="text/javascript" src="../upload/scripts/swfobject.js"></script>	<script type="text/javascript" src="../upload/scripts/jquery.uploadify.min.js"></script>	<script src="../../plugjs/jquery.pagination-master/js/jquery.pagination.js" type="text/javascript"></script>     	<script>		var bookCover = "";  // 图书封面		jQuery(document).ready(function() {    		    App.init(); // initlayout and core plugins		    Index.init();		   		 	// 创建上传组件		    createUpload();		    			// 请求图书分类列表		    queryClassifyList();		 			    		   			// 监听select的切换事件		    $("#typeSelect").bind("change", function(){		    	// 重新加载数据		    	queryBookLength($("#typeSelect").val());		    });			// 监听批量删除点击事件			$("#batchDel").bind("click",function(){				delMoreBook();			});						$("#saveBook").bind("click",function(){				var bookId = $("#bookId").val();			   	var bookName = $("#bookName").val();			    bookName = encodeURI(encodeURI(bookName));			    var bookType = $("#bookType").val();			    var typeName = $.trim($("#bookType  option:selected").text());			    typeName = encodeURI(encodeURI(typeName));			    var bookHeight = $("#bookHeight").val();			    var bookDown = $("#bookDown").val();			    bookDown = encodeURI(encodeURI(bookDown));			    var bookBrief = $("#bookBrief").val();			    bookBrief = encodeURI(encodeURI(bookBrief));			   			   	console.info(bookCover);				$.ajax({					type : "POST",					url: "../../BookAction?opeType=update&bookName="+bookName+"&bookType="+bookType+"&typeName="+typeName+"&bookHeight="+bookHeight+"&bookCover="+bookCover+"&bookBrief="+bookBrief+"&bookId="+bookId+"&bookDown="+bookDown,					dataType:"json",					success: function(data) {						if(data.code=="1"){							// 获取全部数据的个数							queryBookLength(0);							alert("修改成功");						}else{							alert("修改失败");						}					    console.info(data);					}				});		   });		});				// 请求图书分类列表		function queryClassifyList(){			// 获取数据			$.ajax({				type : "POST",				url: "../../ClassifyAction?opeType=queryPage&pageId=1&pageCount=10000&fCode=3",				dataType:"json",				success: function(data) {					// 添加数据					addSelectTypeList(data);				}			});		}				// 将数据添加到select中		function addSelectTypeList(data){			$.each(data.classifyData,function(k,v){				$("#typeSelect").append('<option style="height:30px!important;line-height:30px!important; "  value="'+v.Sort_ID+'"> '+v.Sort_Name+' </option>');				$("#bookType").append('<option style="height:30px!important;line-height:30px!important; "  value="'+v.Sort_ID+'"> '+v.Sort_Name+' </option>');			});			// 获取全部数据的个数		    queryBookLength(0);		}				// 创建上传组件		function createUpload(){			 $("#file_upload").uploadify({			    	//按钮内容			    	'buttonText' : '添加封面',			        //开启调试			        'debug' : false,			        //是否自动上传			        'auto':false,			        //上传方式 必须是get，要不然后台接收不到formData的数据			        'method' : 'get',			        //超时时间			        'successTimeout':99999,			        //附带值			        'formData' : {'type':'add','myTitle':'111','types':'3','content':'content','ncontent':'ncontent'},			        //flash			        'swf' : '../upload/scripts/uploadify.swf', // flash			        //不执行默认的onSelect事件			        'overrideEvents' : ['onDialogClose'],			        //文件选择后的容器ID			        'queueID':'uploader_queue',			        //服务器端脚本使用的文件对象的名称 $_FILES个['upload']			        'fileObjName':'upload',			        //上传处理程序			        'uploader' : '../../UploadAction', // 数据处理url			        //浏览按钮的背景图片路径			        //浏览按钮的宽度			        'width':'100',			        //浏览按钮的高度			        'height':'32',			        //expressInstall.swf文件的路径。			        'expressInstall':'../upload/scripts/expressInstall.swf',			        //在浏览窗口底部的文件类型下拉菜单中显示的文本			        'fileTypeDesc':'支持的格式：',			        //允许上传的文件后缀			        'fileTypeExts':'*.jpg;*.jpge;*.gif;*.png',			        //上传文件的大小限制			        'fileSizeLimit':'3MB',			        //上传之后不自动消失			        'removeCompleted' : false,			        //上传数量			        'queueSizeLimit' : 25,			        //每次更新上载的文件的进展			        'onUploadProgress' : function(file, bytesUploaded, bytesTotal, totalBytesUploaded, totalBytesTotal) {			             //有时候上传进度什么想自己个性化控制，可以利用这个方法			             //使用方法见官方说明			        	console.info(file);			        },			        //选择上传文件后调用			        'onSelect' : function(file) {			            console.info(file);			        },			        //返回一个错误，选择文件的时候触发			        'onSelectError':function(file, errorCode, errorMsg){			        	console.info(errorMsg);			            switch(errorCode) {			                case -100:			                    alert("上传的文件数量已经超出系统限制的"+$('#file_upload').uploadify('settings','queueSizeLimit')+"个文件！");			                    break;			                case -110:			                    alert("文件 ["+file.name+"] 大小超出系统限制的"+$('#file_upload').uploadify('settings','fileSizeLimit')+"大小！");			                    break;			                case -120:			                    alert("文件 ["+file.name+"] 大小异常！");			                    break;			                case -130:			                    alert("文件 ["+file.name+"] 类型不正确！");			                    break;			            }			        },			        //检测FLASH失败调用			        'onFallback':function(){			            alert("您未安装FLASH控件，无法上传图片！请安装FLASH控件后再试。");			        },			        //上传到服务器，服务器返回相应信息到data里			        'onUploadSuccess':function(file, data, response){			        	bookCover = data;			        	console.info(bookCover);			        	//queryTotal();			        },			        'onAllComplete':function(){			        	console.info("111");			        }			    });		}				function up(){			// 获取标题			var title = 111;			// 获取内容			var content = "asda";			var ncontent = "asda";			$('#file_upload').uploadify('settings','formData',{'type':'add','myTitle':title,'types':'3','content':content,'ncontent':ncontent});			$('#file_upload').uploadify('upload','*');		}		function stop(){			console.info("stop");			$('#file_upload').uploadify('stop');		}										// 查询图书的全部个数		function queryBookLength(typeId){			$.ajax({				type : "POST",				url: "../../BookAction?opeType=queryLength&typeId="+typeId,				dataType:"json",				success: function(data) {					console.info(data);					// 得到全部个数之后 初始化分页组件					createPage(typeId, data.length);				}			});		}		// 创建分页组件		function createPage(typeId, length){			// 初始化分页组件			$("#pagination").pagination(length, {  // 一共多少条数据				current_page : 0,  // 初始化时选中第几页数据  0为第一页				items_per_page : 6,  // 每页显示多少条数据				num_display_entries : 5,  // 显示页数				num_edge_entries : 0,				callback : function(page_id){					// 查询每页数据					queryPageBook(typeId, page_id+1);				},				load_first_page : true,				prev_text : "上一页",				next_text : "下一页"			});		}				// 查询每一页图书的数据		function queryPageBook(typeId, pageId){			var pageCount = 6;  // 每页显示6个						// 获取数据			$.ajax({				type : "POST",				url: "../../BookAction?opeType=queryPage&pageId="+pageId+"&pageCount="+pageCount+"&typeId="+typeId,				dataType:"json",				success: function(data) {					console.info(data);					// 添加数据					addPageData(data);				}			});		}				// 添加数据		function addPageData(data){			$("#book_list tbody").empty();  // 删除原来的数据						// 重新添加数据			for(var i=0; i<data.bookData.length; i++){				var trHtml = '<tr class="bookItem" id="'+data.bookData[i].Book_ID+'">';				trHtml += '<td class="bookIdClass">'+data.bookData[i].Book_ID+'</td>';				trHtml += '<td class="bookNameClass">'+data.bookData[i].Book_Name+'</td>';				trHtml += '<td class="bookAbsClass">'+data.bookData[i].Book_Abstract+'</td>';				trHtml += '<td class="bookDownClass" style="display: none;">'+data.bookData[i].Download_Link+'</td>';				trHtml += '<td class="bookTypeNameClass">'+data.bookData[i].Type_Name+'</td>';				trHtml += '<td style="display:none;" class="bookTypeClass">'+data.bookData[i].Type_ID+'</td>';				trHtml += '<td class="bookHeightClass">'+data.bookData[i].Book_Height+'</td>';				trHtml += '<td>'+data.bookData[i].Recommend_Num+'</td>';				trHtml += '<td><a class="update" href="javascript:void(0)" onclick="updateBook('+data.bookData[i].Book_ID+')">修改</a></td>';				trHtml += '</tr>';								$("#book_list tbody").append(trHtml);			}						$(".bookItem .checkboxes").bind("click",function(){				if($(this).parent("span").hasClass("checked")){					$(this).parent("span").removeClass("checked");				}else{					$(this).parent("span").addClass("checked");				}			});		}				// 修改方法		function updateBook(id){			// 弹出弹出框			$('#myModal').modal();						// 根据id获取内容 填充给文本框			var bookName = $("#"+id).find(".bookNameClass").html();			var bookType = $("#"+id).find(".bookTypeClass").html();			var bookHeight = $("#"+id).find(".bookHeightClass").html();			var bookDown = $("#"+id).find(".bookDownClass").html();			var bookAbs = $("#"+id).find(".bookAbsClass").html();						$("#bookId").val(id);			$("#bookName").val(bookName);			$("#bookType").val(bookType);			$("#bookHeight").val(bookHeight);			$("#bookDown").val(bookDown);			$("#bookBrief").val(bookAbs);		}											</script>	<!-- END JAVASCRIPTS -->	<script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-37564768-1']);  _gaq.push(['_setDomainName', 'keenthemes.com']);  _gaq.push(['_setAllowLinker', true]);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script></body><!-- END BODY --></html>